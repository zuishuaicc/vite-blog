import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.Dpoz9nJ7.js";const d=JSON.parse('{"title":"vue3实现defineModel宏","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"views/frontend/vue/vue-defineModel.md","filePath":"views/frontend/vue/vue-defineModel.md","lastUpdated":1757079840000}'),t={name:"views/frontend/vue/vue-defineModel.md"};function h(k,s,e,F,p,D){return n(),a("div",null,[...s[0]||(s[0]=[l(`<h1 id="vue3实现definemodel宏" tabindex="-1">vue3实现defineModel宏 <a class="header-anchor" href="#vue3实现definemodel宏" aria-label="Permalink to &quot;vue3实现defineModel宏&quot;">​</a></h1><h2 id="_1-创建usedefinemodel-tshook" tabindex="-1">1.创建<code>useDefineModel.ts</code>hook <a class="header-anchor" href="#_1-创建usedefinemodel-tshook" aria-label="Permalink to &quot;1.创建\`useDefineModel.ts\`hook&quot;">​</a></h2><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes material-theme-palenight material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;">import</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> {</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> computed</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> }</span><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;"> from</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#C3E88D;--shiki-dark:#C3E88D;">vue</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">type</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> UpdateEvent</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">T</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> extends</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> string</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> \`</span><span style="--shiki-light:#C3E88D;--shiki-dark:#C3E88D;">update:</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">\${</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">T</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">}\`</span></span>
<span class="line"><span style="--shiki-light:#676E95;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">// 辅助类型：从 Props 对象类型中提取所有字符串键</span></span>
<span class="line"><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">type</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> PropsKeys</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">T</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> T</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> extends</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> Record</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;infer</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> K</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> any</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> ?</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> Extract</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">K</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> string</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> :</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> never</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">function</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;"> useDefineModel</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">T</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> extends</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> Record</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">string</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> any</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&gt;,</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> K</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> extends</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> PropsKeys</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">T</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&gt;&gt;(</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-light-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic;">  props</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> T</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-light-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic;">  field</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> K</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;">  emits</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> (</span><span style="--shiki-light:#BABED8;--shiki-light-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic;">e</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> UpdateEvent</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">K</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">&gt;,</span><span style="--shiki-light:#BABED8;--shiki-light-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic;"> payload</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> T</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">[</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">K</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">]</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> void</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">  const</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> visible</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;"> computed</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">(</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">    get</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;">      return</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> props</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">[</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">field</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">]</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">    },</span></span>
<span class="line"><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">    set</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#BABED8;--shiki-light-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic;">val</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> T</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">[</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">K</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">]</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;">      return</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;"> emits</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">(</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">\`</span><span style="--shiki-light:#C3E88D;--shiki-dark:#C3E88D;">update:</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">\${</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">field</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">}\`</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> val</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">)</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">  }</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">)</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;">  return</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">    visible</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">  }</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">}</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;">export</span><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;"> default</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> useDefineModel</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div>`,3)])])}const B=i(t,[["render",h]]);export{d as __pageData,B as default};
